namespace MicroserviceGen.CLI.Controllers.Cache.Scripts;

public class NLayerScripts
{
    public const string Postgres = "echo \"Setting up cache with postgres\"\ncd _PasteNameHere_.Domain\ndotnet add package Microsoft.Extensions.Caching.Postgres\ncd ..\ncd _PasteNameHere_.Infrastructure\ndotnet add package Microsoft.Extensions.Caching.Postgres\ncd ..\ncd _PasteNameHere_.Web\ndotnet add package Microsoft.Extensions.Caching.Postgres\n\nsed -i \"/var builder = WebApplication.CreateBuilder(args);/a \\\\\nbuilder.Services.AddDistributedPostgresCache(options =>\\\\\n{\\\\\n    options.ConnectionString = builder.Configuration.GetConnectionString(\\\"PostgresCacheSettings\\\");\\\\\n    options.SchemaName = builder.Configuration.GetValue<string>(\\\"PostgresCacheSettings:SchemaName\\\", \\\"public\\\");\\\\\n    options.TableName = builder.Configuration.GetValue<string>(\\\"PostgresCacheSettings:TableName\\\", \\\"cache\\\");\\\\\n    options.CreateIfNotExists = builder.Configuration.GetValue(\\\"PostgresCacheSettings:CreateIfNotExists\\\", true);\\\\\n    options.UseWAL = builder.Configuration.GetValue(\\\"PostgresCacheSettings:UseWAL\\\", false);\\\\\n});\" Program.cs\n\nAPPSETTINGS=\"appsettings.json\"\nAPPSETTINGS_DEV=\"appsettings.Development.json\"\n# Note the different connection string format for PostgreSQL\nNEW_CONNECTION=\"\\\"PostgresCacheSettings\\\": {\\\\\n    \\\"ConnectionString\\\": \\\"Host=your_host;Database=your_database;Username=your_username;Password=your_password\\\",\\\\\n    \\\"SchemaName\\\": \\\"public\\\",\\\\\n    \\\"TableName\\\": \\\"cache\\\",\\\\\n    \\\"CreateIfNotExists\\\": true,\\\\\n    \\\"UseWAL\\\": false\\\\\n  },\"\nsed -i \"/^{/a $NEW_CONNECTION\" \"$APPSETTINGS\"\nsed -i \"/^{/a $NEW_CONNECTION\" \"$APPSETTINGS_DEV\"\ncd ..\n";
    public const string Redis = "echo \"Setting up cache with redis\"\ncd _PasteNameHere_.Domain\ndotnet add package Microsoft.Extensions.Caching.StackExchangeRedis --version 8.0.20\ncd ..\ncd _PasteNameHere_.Infrastructure\ndotnet add package Microsoft.Extensions.Caching.StackExchangeRedis --version 8.0.20\ncd ..\ncd _PasteNameHere_.Web\ndotnet add package Microsoft.Extensions.Caching.StackExchangeRedis --version 8.0.20\n\nsed -i \"/var builder = WebApplication.CreateBuilder(args);/a \\\\\nbuilder.Services.AddStackExchangeRedisCache(options =>\\\\\n{\\\\\n    options.Configuration = builder.Configuration[\\\"RedisCacheSettings:DefaultConnection\\\"];\\\\\n    options.InstanceName = \\\"SampleInstance\\\";\\\\\n});\" Program.cs\n\nAPPSETTINGS=\"appsettings.json\"\nAPPSETTINGS_DEV=\"appsettings.Development.json\"\n# Note the different connection string format for PostgreSQL\nNEW_CONNECTION=\"\\\"RedisCacheSettings\\\": {\\n    \\\"DefaultConnection\\\": \\\"localhost:6379\\\"\\n  },\"\nsed -i \"/^{/a $NEW_CONNECTION\" \"$APPSETTINGS\"\nsed -i \"/^{/a $NEW_CONNECTION\" \"$APPSETTINGS_DEV\"\ncd ..\n\n";
}